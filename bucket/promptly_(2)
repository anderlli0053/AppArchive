{
  "version": "1.2.0",
  "description": "A Command Palette for Tecnomatix Process Simulate",
  "homepage": "https://icarus-consult.de",
  "license": "non-free",
  "url": "//promptly-apps.icarus-consult.local/Software/PROMPTLY/promptly/1.2.0/promptly_v1.2.0.zip",
  "post_install": [
    "# Copy to emPower Directory",
    "$emPowerDir = \"\";",
    "if(Test-Path -Path 'HKLM:\\SOFTWARE\\TecnomatixRoot') {",
    "        Write-Host Shared Tecnomatix is installed",
    "        $shared = Get-ItemPropertyValue -Path 'HKLM:\\SOFTWARE\\TecnomatixRoot\\' -Name SymbolicLinkLocation",
    "        $emPowerDir = $shared + \"TecnomatixCurrent\\eMPower\"",
    "} elseif(Test-Path -Path 'HKLM:\\SOFTWARE\\Tecnomatix\\eMPower') {",
    "        Write-Host Single Tecnomatix is installed",
    "        $emPowerDir = Get-ItemPropertyValue -Path 'HKLM:\\SOFTWARE\\Tecnomatix\\eMPower' -Name eMPowerDir",
    "} else {",
    "        Write-Host Could not find a valid Tecnomatix Installation",
    "}",
    "Write-Host \"Tecnomatix detected at \" $emPowerDir",
    "$xmls = $dir + \"\\DotNetExternalApplications\"",
    "Copy-Item $xmls -Destination $eMPowerDir -Force -Recurse",
    "$cmds = $dir + \"\\DotNetCommands\"",
    "Copy-Item $cmds -Destination $eMPowerDir -Force -Recurse"
  ],
  "post_uninstall": [
    "# Copy to emPower Directory",
    "$emPowerDir = \"\";",
    "if(Test-Path -Path 'HKLM:\\SOFTWARE\\TecnomatixRoot') {",
    "        Write-Host Shared Tecnomatix is installed",
    "        $shared = Get-ItemPropertyValue -Path 'HKLM:\\SOFTWARE\\TecnomatixRoot\\' -Name SymbolicLinkLocation",
    "        $emPowerDir = $shared + \"TecnomatixCurrent\\eMPower\"",
    "} elseif(Test-Path -Path 'HKLM:\\SOFTWARE\\Tecnomatix\\eMPower') {",
    "        Write-Host Single Tecnomatix is installed",
    "        $emPowerDir = Get-ItemPropertyValue -Path 'HKLM:\\SOFTWARE\\Tecnomatix\\eMPower' -Name eMPowerDir",
    "} else {",
    "        Write-Host Could not find a valid Tecnomatix Installation",
    "}",
    "Write-Host \"Tecnomatix detected at \" $emPowerDir",
    "$cmd = $emPowerDir + \"\\DotNetCommands\\Promptly\"",
    "Remove-Item -Recurse -Force $cmd",
    "$xml = $emPowerDir + \"\\DotNetExternalApplications\\Promptly.xml\"",
    "Remove-Item -Recurse -Force $xml"
  ]
}